<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. Regression Testing* &mdash; Material Model Laboratory 3.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Material Model Laboratory 3.0 documentation" href="index.html" />
    <link rel="prev" title="3.4. Writing to Messages to the Console and/or Log File" href="material/comm.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="regression-testing">
<span id="rtest"></span><h1>4. Regression Testing*<a class="headerlink" href="#regression-testing" title="Permalink to this headline">¶</a></h1>
<p>Regression testing is crucial to the model development process. Regression
tests in Matmodlab are special purpose problems that serve several purposes.
Most notably, component tests for the core capabilities of Matmodlab and
verification and validation (V&amp;V) of material models. In the first role,
problems are fast running and exercise specific features of Matmodlab in a
unit-test type fashion. In the second, material models are exercised through
specific paths with known, or expected outcomes. Each type of test is
supported through the <tt class="docutils literal"><span class="pre">core.test.TestBase</span></tt>. New tests are created as
subclasses of <tt class="docutils literal"><span class="pre">TestBase</span></tt>.</p>
<div class="section" id="basic-examples">
<span id="basic-test-ex"></span><h2>4.1. Basic Examples<a class="headerlink" href="#basic-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="standard-material-test">
<h3>Standard Material Test<a class="headerlink" href="#standard-material-test" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">matmodlab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">path_table_id</span> <span class="o">=</span> <span class="s">&quot;path_table&quot;</span>

<span class="k">class</span> <span class="nc">TestPathTable</span><span class="p">(</span><span class="n">TestBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">job</span> <span class="o">=</span> <span class="n">path_table_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;fast&quot;</span><span class="p">,</span> <span class="s">&quot;feature&quot;</span><span class="p">,</span> <span class="s">&quot;path&quot;</span><span class="p">,</span> <span class="s">&quot;table&quot;</span><span class="p">,</span> <span class="s">&quot;builtin&quot;</span><span class="p">]</span>

<span class="nd">@matmodlab</span>
<span class="k">def</span> <span class="nf">run_path_table</span><span class="p">():</span>

    <span class="n">job</span> <span class="o">=</span> <span class="n">path_table_id</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;0E+00 0E+00 0E+00 0E+00 0E+00 0E+00 0E+00</span>
<span class="s">              1E+00 1E-01 0E+00 0E+00 0E+00 0E+00 0E+00</span>
<span class="s">              2E+00 0E+00 0E+00 0E+00 0E+00 0E+00 0E+00&quot;&quot;&quot;</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">Driver</span><span class="p">(</span><span class="s">&quot;Continuum&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">path_input</span><span class="o">=</span><span class="s">&quot;table&quot;</span><span class="p">,</span>
                    <span class="n">step_multiplier</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">cfmt</span><span class="o">=</span><span class="s">&quot;222222&quot;</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
                    <span class="n">tfmt</span><span class="o">=</span><span class="s">&quot;time&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;K&quot;</span><span class="p">:</span><span class="mf">1.350E+11</span><span class="p">,</span> <span class="s">&quot;G&quot;</span><span class="p">:</span><span class="mf">5.300E+10</span><span class="p">}</span>
    <span class="n">material</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="s">&quot;elastic&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
    <span class="n">mps</span> <span class="o">=</span> <span class="n">MaterialPointSimulator</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">mps</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run_path_table</span><span class="p">()</span>
</pre></div>
</div>
<p>A test is created by subclassing <tt class="docutils literal"><span class="pre">TestBase</span></tt>. Minimally, a test defines
<tt class="docutils literal"><span class="pre">job</span></tt> and <tt class="docutils literal"><span class="pre">keywords</span></tt> attributes. The <tt class="docutils literal"><span class="pre">job</span></tt> attribute is used
internally for test identification and <tt class="docutils literal"><span class="pre">keywords</span></tt> for test filtering and
organization. The module containing the test must also define a
<tt class="docutils literal"><span class="pre">run_&lt;job&gt;</span></tt> function (where <tt class="docutils literal"><span class="pre">&lt;job&gt;</span></tt> is replaced with the actual
<tt class="docutils literal"><span class="pre">job</span></tt> of the test) to run the actual simulation. For each test so defined,
Matmodlab expects the existence of a base file <tt class="docutils literal"><span class="pre">&lt;job&gt;.base_exo</span></tt> containing
the expected, or baseline, results. Matmodlab also expects, on exercising
<tt class="docutils literal"><span class="pre">run_&lt;job&gt;</span></tt>, the creation of the results file <tt class="docutils literal"><span class="pre">&lt;job&gt;.exo</span></tt>. At the
completion of the test, <tt class="docutils literal"><span class="pre">&lt;job&gt;.exo</span></tt> is compared to <tt class="docutils literal"><span class="pre">&lt;job&gt;.base_exo</span></tt> and
differences (if any) determined by <tt class="docutils literal"><span class="pre">exodiff</span></tt>.</p>
</div>
</div>
<div class="section" id="command-line-interface">
<h2>4.2. Command-Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">test</span></tt> subcommand of <tt class="docutils literal"><span class="pre">mml</span></tt> gathers, runs, and analyzes tests. To run
tests with Matmodlab, be sure that <tt class="docutils literal"><span class="pre">matmodlab/bin</span></tt> is on your path and
execute:</p>
<div class="highlight-python"><div class="highlight"><pre>$ mml test
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">mml</span> <span class="pre">test</span></tt> will create a results directory <tt class="docutils literal"><span class="pre">TestResults.&lt;platform&gt;</span></tt>, where
<tt class="docutils literal"><span class="pre">&lt;platform&gt;</span></tt> is is the machine platform (as determined by Python&#8217;s
<tt class="docutils literal"><span class="pre">sys.platform</span></tt>) on which the tests are being run. The following files and
directories will be produced by <tt class="docutils literal"><span class="pre">mml</span> <span class="pre">test</span></tt> in the
<tt class="docutils literal"><span class="pre">TestResults.&lt;platform&gt;</span></tt>, directory</p>
<div class="highlight-python"><div class="highlight"><pre>$ ls
TestsResults.darwin completed_tests.db mmd/ summary.html
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">completed_tests.db</span></tt> is a database file containing information on all
completed tests and <tt class="docutils literal"><span class="pre">summary.html</span></tt> is an html summary file, viewable in any
web browser.</p>
<p><tt class="docutils literal"><span class="pre">mml</span> <span class="pre">test</span></tt> searches for test specification files in the <tt class="docutils literal"><span class="pre">matmodlab/tests</span></tt>
directory and directories in the <tt class="docutils literal"><span class="pre">tests</span></tt> section of the configuration file.
Test files are python files whose names match <tt class="docutils literal"><span class="pre">(?:^|[\\b_\\.-])[Tt]est</span></tt>.
Matmodlab supports</p>
<div class="section" id="mml-test-options">
<h3>mml test Options<a class="headerlink" href="#mml-test-options" title="Permalink to this headline">¶</a></h3>
<p>The full list of options to <tt class="docutils literal"><span class="pre">mml</span> <span class="pre">test</span></tt> is:</p>
<div class="highlight-python"><div class="highlight"><pre>usage: mml test [-h] [-k K] [-K K] [-X] [-j J] [--no-tear-down] [--html]
                [--overlay] [-E] [-l] [--rebaseline]
                [sources [sources ...]]

mml test: run the matmodlab tests. By default, tests are found in
MML_ROOT/tests and any other directories and/or files found in the tests group
of the MATMODLABRC file (if any).

positional arguments:
  sources         [Optional] directores and/or files to find matmodlab tests.
                  The default directories will not be searched.

optional arguments:
  -h, --help      show this help message and exit
  -k K            Keywords to include [default: ]
  -K K            Keywords to exclude [default: ]
  -X              Do not stop on test initialization failure (tests that fail
                  to initialize will be skipped) [default: False]
  -j J            Number of simutaneous tests to run [default: ]
  --no-tear-down  Do not tear down passed tests on completion [default: ]
  --html          Write html summary of results (negates tear down) [default: ]
  --overlay       Create overlays of failed tests with baseline (negates tear
                  down) [default: ]
  -E              Do not use matmodlabrc configuration file [default: False]
  -l              List tests and exit [default: False]
  --rebaseline    Rebaseline test in PWD [default: False]
</pre></div>
</div>
</div>
</div>
<div class="section" id="testbase-api">
<h2>4.3. TestBase API<a class="headerlink" href="#testbase-api" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="TestBase">
<em class="property">class </em><tt class="descname">TestBase</tt><a class="headerlink" href="#TestBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Instances of the TestBase represent individual tests. The class is intended
to be used as a base class, with specific tests being implemented by
concrete subclasses. The class implements the interface needed by mml test
to allow it to drive the test, and methods that the test code can use check
for and report various kinds of failure. Each instance of TestBase will run
a single test.</p>
</dd></dl>

<div class="section" id="required-attributes-of-testbase">
<h3>Required Attributes of TestBase<a class="headerlink" href="#required-attributes-of-testbase" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="TestBase.keywords">
<tt class="descclassname">TestBase.</tt><tt class="descname">keywords</tt><a class="headerlink" href="#TestBase.keywords" title="Permalink to this definition">¶</a></dt>
<dd><p>List of keywords identifying the test. Each test must define
one of <em>long</em>, <em>medium</em>, <em>fast</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="TestBase.job">
<tt class="descclassname">TestBase.</tt><tt class="descname">job</tt><a class="headerlink" href="#TestBase.job" title="Permalink to this definition">¶</a></dt>
<dd><p>The test identifier.</p>
</dd></dl>

</div>
<div class="section" id="definable-attributes-of-testbase">
<h3>Definable Attributes of TestBase<a class="headerlink" href="#definable-attributes-of-testbase" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="TestBase.base_res">
<tt class="descclassname">TestBase.</tt><tt class="descname">base_res</tt><a class="headerlink" href="#TestBase.base_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Base result file name  [default: <tt class="docutils literal"><span class="pre">job.base_exo</span></tt>]</p>
</dd></dl>

<dl class="attribute">
<dt id="TestBase.exodiff">
<tt class="descclassname">TestBase.</tt><tt class="descname">exodiff</tt><a class="headerlink" href="#TestBase.exodiff" title="Permalink to this definition">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">exodiff</span></tt> diff file [default: <tt class="docutils literal"><span class="pre">tests/base.exodiff</span></tt>]</p>
</dd></dl>

</div>
<div class="section" id="useful-read-only-attributes-of-testbase">
<h3>Useful Read-Only Attributes of TestBase<a class="headerlink" href="#useful-read-only-attributes-of-testbase" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="TestBase.test_dir">
<tt class="descclassname">TestBase.</tt><tt class="descname">test_dir</tt><a class="headerlink" href="#TestBase.test_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>The directory in which the test will be run</p>
</dd></dl>

</div>
</div>
<div class="section" id="methods">
<h2>4.4. Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<p>As described in <a class="reference internal" href="#basic-test-ex"><em>Basic Examples</em></a>, minimally, a test subclasses <tt class="docutils literal"><span class="pre">TestBase</span></tt> and defines a <tt class="docutils literal"><span class="pre">job</span></tt> and <tt class="docutils literal"><span class="pre">keywords</span></tt>, Matmodlab will set up the test, run, and perform post processing.  Optionally, a test may define the following methods.</p>
<dl class="method">
<dt id="TestBase.setup">
<tt class="descclassname">TestBase.</tt><tt class="descname">setup</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#TestBase.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Test setup. Minimally, setup should check for existence of needed files and
create the test directory.</p>
</dd></dl>

<dl class="method">
<dt id="TestBase.pre_hook">
<tt class="descclassname">TestBase.</tt><tt class="descname">pre_hook</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#TestBase.pre_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each test is run and after setup.  The base pre_hook performs a no-op.</p>
</dd></dl>

<dl class="method">
<dt id="TestBase.run">
<tt class="descclassname">TestBase.</tt><tt class="descname">run</tt><big>(</big><big>)</big><a class="headerlink" href="#TestBase.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the test.  Set test.status to one of FAILED_TO_RUN, FAILED, DIFFED, PASSED</p>
</dd></dl>

<dl class="method">
<dt id="TestBase.tear_down">
<tt class="descclassname">TestBase.</tt><tt class="descname">tear_down</tt><big>(</big><em>force=0</em><big>)</big><a class="headerlink" href="#TestBase.tear_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Tear down the test. The standard tears down the test by removing the test directory (if test passed).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>force</strong> (<em>int</em>) &#8211; Force tear down even if test failed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="TestBase.post_hook">
<tt class="descclassname">TestBase.</tt><tt class="descname">post_hook</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#TestBase.post_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Run after test is run.  The standard post_hook performs a no-op.</p>
</dd></dl>

<dl class="method">
<dt id="TestBase.make_test_dir">
<tt class="descclassname">TestBase.</tt><tt class="descname">make_test_dir</tt><big>(</big><big>)</big><a class="headerlink" href="#TestBase.make_test_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the test directory TestBase.test_dir</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Material Model Laboratory</a></h1>





<p>
<iframe src="https://ghbtns.com/github-btn.html?user=tjfulle&repo=matmodlab&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro/index.html">1. Introduction and Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution/index.html">2. Job Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="material/index.html">3. Material Model Library</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">4. Regression Testing*</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-examples">4.1. Basic Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#standard-material-test">Standard Material Test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-interface">4.2. Command-Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mml-test-options">mml test Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testbase-api">4.3. TestBase API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#required-attributes-of-testbase">Required Attributes of TestBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#definable-attributes-of-testbase">Definable Attributes of TestBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#useful-read-only-attributes-of-testbase">Useful Read-Only Attributes of TestBase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#methods">4.4. Methods</a></li>
</ul>
</li>
</ul>


<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Tim Fuller, Scot Swan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.2.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster </a>
      
      |
      <a href="_sources/test.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>
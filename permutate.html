<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Permutation &mdash; Material Model Laboratory 2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Material Model Laboratory 2.0 documentation" href="index.html" />
    <link rel="up" title="User’s Guide" href="users.html" />
    <link rel="next" title="User Configuration" href="config.html" />
    <link rel="prev" title="Command Line Interface" href="clparse.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="config.html" title="User Configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="clparse.html" title="Command Line Interface"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Material Model Laboratory 2.0 documentation</a> &raquo;</li>
          <li><a href="users.html" accesskey="U">User&#8217;s Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="permutation">
<span id="inpperm"></span><h1>Permutation<a class="headerlink" href="#permutation" title="Permalink to this headline">¶</a></h1>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">clean up the description to be more clear what func is (a function that
runs a simulation)</p>
</div>
<p>It is useful to investiage sensitivities of models to model inputs.
Permutating values of model inputs involves running jobs with different
realization of parameters. Ideal for investigating model sensitivities. A
permutator instance is created through the <tt class="docutils literal"><span class="pre">Permutator</span></tt> constructor.
Minimally, the constructor requires a function to evaluate <tt class="docutils literal"><span class="pre">func</span></tt>, initial
parameters <tt class="docutils literal"><span class="pre">xinit</span></tt>, and a <tt class="docutils literal"><span class="pre">runid</span></tt>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">permutator</span> <span class="o">=</span> <span class="n">Permutator</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xinit</span><span class="p">,</span> <span class="n">runid</span><span class="p">)</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">func</span></tt> is called as <tt class="docutils literal"><span class="pre">func(x,</span> <span class="pre">*args)</span></tt> where <tt class="docutils literal"><span class="pre">x</span></tt> are the current values of
the permutated variables and <tt class="docutils literal"><span class="pre">args</span></tt> contains in its first two components:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dirname</span><span class="p">,</span> <span class="n">runid</span> <span class="o">=</span> <span class="n">args</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">dirname</span></tt> is the directory where simulations should be run, and
<tt class="docutils literal"><span class="pre">runid</span></tt> the current runid.</p>
<div class="section" id="permutator-constructor">
<h2>Permutator Constructor<a class="headerlink" href="#permutator-constructor" title="Permalink to this headline">¶</a></h2>
<p>The formal parameters to <tt class="docutils literal"><span class="pre">Permutator</span></tt> are</p>
<dl class="class">
<dt id="Permutator">
<em class="property">class </em><tt class="descname">Permutator</tt><big>(</big><em>func</em>, <em>xinit</em>, <em>runid</em>, <em>method=&quot;zip&quot;</em>, <em>correlations=False</em>, <em>verbosity=1</em>, <em>descriptor=None</em>, <em>nprocs=1</em>, <em>funcargs=</em>, <span class="optional">[</span><span class="optional">]</span><em>d=None</em><big>)</big><a class="headerlink" href="#Permutator" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Permutator object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>func</strong> &#8211; Function that evaluates a matmodlab simulation</li>
<li><strong>xinit</strong> (<em>List of PermutateVariable objects</em>) &#8211; Initial values of simulation parameters.</li>
<li><strong>runid</strong> (<em>str</em>) &#8211; runid for the parent Permutation process.</li>
<li><strong>method</strong> (<em>str</em>) &#8211; The method for determining how to combine parameter values. One of zip or combine. The zip method runs one job for each set of parameters (and, thus, the number of realizations for each parameter must be identical), the combine method runs every combination of parameters.</li>
<li><strong>correlations</strong> (<em>bool</em>) &#8211; Create correlation table and plots of relating permutated parameters and return value of func [default: False].</li>
<li><strong>descriptor</strong> (<em>int of None</em>) &#8211; Descriptors of return values from func</li>
<li><strong>nprocs</strong> &#8211; Number of simultaneous jobs [default: None]</li>
<li><strong>funcargs</strong> (<em>list</em>) &#8211; Additional arguments to be sent to func.  Will be appended to the args already passed.</li>
<li><strong>d</strong> (<em>str or None</em>) &#8211; Parent directory to run jobs.  If the directory does not exist, it will be created.  If not given, the current directory will be used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Each <tt class="docutils literal"><span class="pre">Permutator</span></tt> job creates a directory <tt class="docutils literal"><span class="pre">runid.eval</span></tt> with the following
contents:</p>
<div class="highlight-python"><div class="highlight"><pre>ls runid.eval
eval_000/    eval_002/    mml-evaldb.xml
eval_001/    ...          runid.log
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">eval_...</span></tt> directory holds the output of the ith job and a <tt class="docutils literal"><span class="pre">params.in</span></tt>
file with the values of each permutated parameter for that job.
<tt class="docutils literal"><span class="pre">mml-tabular.xml</span></tt> contains a summary of each job run. <tt class="docutils literal"><span class="pre">mml</span> <span class="pre">view</span></tt>
recognizes <tt class="docutils literal"><span class="pre">mml-tabular.xml</span></tt> files.</p>
</div>
<div class="section" id="permutatevariable-factory-method">
<h2>PermutateVariable Factory Method<a class="headerlink" href="#permutatevariable-factory-method" title="Permalink to this headline">¶</a></h2>
<p>The formal parameters to <tt class="docutils literal"><span class="pre">PermutateVariable</span></tt> are</p>
<dl class="function">
<dt id="PermutateVariable">
<tt class="descname">PermutateVariable</tt><big>(</big><em>name</em>, <em>init</em>, <em>method=&quot;list&quot;</em>, <em>b=None</em>, <em>N=10</em><big>)</big><a class="headerlink" href="#PermutateVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PermutateVariable object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) &#8211; Name of variable</li>
<li><strong>init</strong> (<em>float or list</em>) &#8211; Initial value or values, dependending on method.</li>
<li><strong>method</strong> (<em>str</em>) &#8211; Method used to generate all values.  If list, than all values shall be given in init.  Otherwise, values will be generated. Valid methods are list, weibull, uniform, normal, percentage.</li>
<li><strong>b</strong> (<em>float</em>) &#8211; For methods other than list, values are generated from a function called as fun(init, b, N).  The meaning of b is dependent on which method fun represents.</li>
<li><strong>N</strong> (<em>int</em>) &#8211; For methods other than list, the number of values to generate</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>The following input stub demonstrates how to permutate the <tt class="docutils literal"><span class="pre">K</span></tt> parameter</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">K</span> <span class="o">=</span> <span class="n">PermutateVariable</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">155</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">K</span> <span class="o">=</span> <span class="n">PermutateVariable</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;weibull&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">K</span> <span class="o">=</span> <span class="n">PermutateVariable</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;percentage&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The following input stub demonstrates how to permutate the <tt class="docutils literal"><span class="pre">K</span></tt> and <tt class="docutils literal"><span class="pre">G</span></tt>
parameters</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">matmodlab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="n">path</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">    0 0 222222 0 0 0 0 0 0</span>
<span class="s">    1 1 222222 1 0 0 0 0 0</span>
<span class="s">    2 1 222222 2 0 0 0 0 0</span>
<span class="s">    3 1 222222 1 0 0 0 0 0</span>
<span class="s">    4 1 222222 0 0 0 0 0 0</span>
<span class="s">    &quot;&quot;&quot;</span>
    <span class="n">d</span><span class="p">,</span> <span class="n">runid</span> <span class="o">=</span> <span class="n">args</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">logfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">runid</span> <span class="o">+</span> <span class="s">&quot;.log&quot;</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="n">logfile</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c"># set up the driver</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">Driver</span><span class="p">(</span><span class="s">&quot;Continuum&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">step_multiplier</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">estar</span><span class="o">=-.</span><span class="mi">5</span><span class="p">)</span>

    <span class="c"># set up the material</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;K&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot;G&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
    <span class="n">material</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="s">&quot;elastic&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>

    <span class="c"># set up and run the model</span>
    <span class="n">mps</span> <span class="o">=</span> <span class="n">MaterialPointSimulator</span><span class="p">(</span><span class="n">runid</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="n">mps</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">pres</span> <span class="o">=</span> <span class="n">mps</span><span class="o">.</span><span class="n">extract_from_db</span><span class="p">([</span><span class="s">&quot;PRESSURE&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">pres</span><span class="p">)</span>

<span class="nd">@matmodlab</span>
<span class="k">def</span> <span class="nf">runner</span><span class="p">():</span>
    <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;zip&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">runid</span> <span class="o">=</span> <span class="s">&quot;perm_{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">PermutateVariable</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="mf">125e9</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;weibull&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">PermutateVariable</span><span class="p">(</span><span class="s">&quot;G&quot;</span><span class="p">,</span> <span class="mf">45e9</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;percentage&quot;</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">xinit</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">G</span><span class="p">]</span>
    <span class="n">permutator</span> <span class="o">=</span> <span class="n">Permutator</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xinit</span><span class="p">,</span> <span class="n">runid</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;MAX_PRES&quot;</span><span class="p">],</span>
                            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">correlations</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                            <span class="n">funcargs</span><span class="o">=</span><span class="p">[</span><span class="n">runid</span><span class="p">])</span>
    <span class="n">permutator</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">runner</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Material Model Laboratory</a></h1>





<p>
<iframe src="http://ghbtns.com/github-btn.html?user=tjfulle&repo=matmodlab&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="background.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="users.html">User&#8217;s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="solmeth.html">Solution Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="run.html">Running a Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="factory.html">Factory Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="aba.html">Abaqus Materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="addon.html">Optional Material Addons</a></li>
<li class="toctree-l2"><a class="reference internal" href="clparse.html">Command Line Interface</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Permutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">User Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="post.html">Postprocessing Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="build.html">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Annoted Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Developers&#8217;s Guide</a></li>
</ul>


<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Tim Fuller, Scot Swan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster </a>
      
      |
      <a href="_sources/permutate.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>